<!DOCTYPE html>
<html lang="si">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SFG Quotation - Shehani Fiberglass Works</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        :root {
            --dark-blue: #004085;
            --light-gray: #e9ecef;
            --border-color: #777;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f4f4f4;
            margin: 10px;
            display: flex;
            justify-content: center;
        }

        .main-wrapper {
            display: flex;
            width: 1400px; 
            gap: 20px;
        }

        /* --- Left Side: Form --- */
        .form-container {
            width: 40%;
            border: 1px solid var(--border-color);
            padding: 0;
            background-color: #fff;
            align-self: flex-start;
        }

        .header-bar {
            background-color: var(--dark-blue);
            color: white;
            text-align: center;
            padding: 8px;
            margin: 0;
            font-size: 18px;
            font-weight: bold;
        }

        .form-content { padding: 15px; }

        .row { display: flex; gap: 10px; margin-bottom: 8px; align-items: center; }
        .row label { width: 130px; font-weight: bold; font-size: 13px; }
        .row input, .row select { 
            padding: 4px; border: 1px solid var(--border-color); border-radius: 2px; flex: 1;
        }

        .items-pricing-box {
            background-color: #d1d1d1;
            padding: 8px;
            border: 1px solid #999;
            margin-top: 10px;
        }

        .item-entry { margin-bottom: 8px; border-bottom: 1px dashed #666; padding-bottom: 5px; }
        
        .hand-icons { display: flex; align-items: center; gap: 5px; margin: 5px 0; }
        .hand-box { display: flex; align-items: center; gap: 3px; font-weight: bold; font-size: 11px; }

        .btn-group { display: flex; gap: 10px; margin-top: 5px; }
        .btn-add { background: #004085; color: white; border: none; padding: 3px 10px; cursor: pointer; border-radius: 3px; font-weight: bold; font-size: 12px; }
        .btn-del { background: #c82333; color: white; border: none; padding: 3px 10px; cursor: pointer; border-radius: 3px; font-weight: bold; font-size: 12px; }

        .terms-box { margin-top: 15px; font-size: 12px; font-weight: bold; }
        .terms-box div { margin-bottom: 3px; display: flex; align-items: center; gap: 5px; }

        /* UPLOAD SECTION */
        .upload-section { margin-top: 10px; padding: 8px; border: 1px dashed #004085; background: #f0f4f8; }
        .upload-controls { display: flex; align-items: center; gap: 10px; margin-top: 5px; }
        .btn-img-del { background: #dc3545; color: white; border: none; padding: 2px 8px; cursor: pointer; border-radius: 3px; font-size: 10px; }

        .bottom-btns { display: flex; justify-content: center; gap: 20px; margin-top: 20px; padding-bottom: 20px; flex-wrap: wrap; }
        .print-btn { background: linear-gradient(#1c69b5, #004085); border-radius: 25px; color: white; border: none; padding: 8px 30px; cursor: pointer; display: flex; align-items: center; gap: 5px; font-weight: bold; }
        .save-btn { background: linear-gradient(#88c45c, #4c8c2b); border-radius: 25px; color: white; border: none; padding: 8px 30px; cursor: pointer; display: flex; align-items: center; gap: 5px; font-weight: bold; }
        .dash-link { background: #6c757d; border-radius: 25px; color: white; border: none; padding: 8px 30px; text-decoration: none; font-weight: bold; font-size: 13.5px; display: flex; align-items: center; }

        /* --- Right Side: Preview --- */
        .preview-container {
            width: 210mm;
            height: 297mm;
            border: 1px solid #999;
            background-color: white;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            padding: 0;
            overflow: hidden;
        }

        .preview-content { 
            flex-grow: 1; 
            padding: 5mm 15mm 0 15mm; 
        }

        .preview-header { border-top: 8px solid var(--dark-blue); padding: 0; }
        .logo-section { text-align: center; margin-bottom: 0px; margin-top: 5px; } 
        
        .logo-img, .footer-banner-img { 
            width: calc(100% - 30mm); 
            height: auto; 
            display: block; 
            margin: 0 auto; 
        }

        .info-grid { 
            display: flex; 
            justify-content: space-between; 
            margin-top: 5px; 
            font-size: 13px; 
        }

        .customer-info-block {
            display: flex;
            flex-direction: row;
        }
        .to-label { font-weight: bold; min-width: 25px; }
        .customer-details { display: flex; flex-direction: column; }
        #out-address { display: block; margin-top: 2px; line-height: 1.5; }
        
        .subject-bar { 
            background-color: #f0f4f8 !important; border-left: 5px solid var(--dark-blue); 
            padding: 8px 10px; margin: 15px 0; 
            font-weight: bold; color: var(--dark-blue); 
            -webkit-print-color-adjust: exact;
            min-height: 20px; font-size: 19px; text-transform: uppercase;
        }

        table { width: 100%; border-collapse: collapse; margin-top: 15px; font-size: 15px; table-layout: fixed; }
        th { background-color: var(--dark-blue) !important; color: white !important; padding: 10px 8px; text-align: left; -webkit-print-color-adjust: exact; font-size: 14px; }
        
        #out-table-body td { padding: 12px 8px; border-bottom: 1px solid #ddd; word-wrap: break-word; line-height: 1.6; }
        
        .text-right { text-align: right; }

        .col-desc { width: 48%; }
        .col-size { width: 10%; }
        .col-side { width: 8%; }
        .col-qty   { width: 6%; }
        .col-price { width: 14%; }
        .col-total { width: 14%; }

        .summary-container {
            display: flex;
            justify-content: flex-end;
            margin-top: 5px;
            width: 100%;
        }

        .calculation-side {
            width: 100%;
        }

        .total-row { 
            display: flex; 
            justify-content: flex-end; 
            padding: 3px 0;
            font-size: 15px;
        }

        .total-row span:first-child {
            margin-right: 15px;
        }

        .total-row span:last-child { 
            width: 14%; 
            text-align: right;
            padding-right: 8px;
        }

        .total-banner { 
            background-color: var(--dark-blue) !important; color: white !important; 
            padding: 10px; display: flex; justify-content: space-between; 
            margin-top: 5px; font-weight: bold; -webkit-print-color-adjust: exact;
            font-size: 16px;
        }

        .footer-terms-wrap {
            margin-top: 15px;
            font-size: 12.5px; 
            line-height: 1.4;
        }

        .stamp-wrap {
            margin-top: 10px; 
            width: 4cm; height: 4cm;
            display: flex; justify-content: center; align-items: center;
            float: right;
        }
        #out-stamp { max-width: 100%; max-height: 100%; object-fit: contain; display: none; }

        .footer-signs { 
            margin-top: auto; 
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            padding: 0 15mm 10px 15mm;
        }

        #qrcode-wrap { width: 3.0cm; height: 3.0cm; display: flex; align-items: center; justify-content: center; visibility: hidden; }
        .sign-block { text-align: right; font-size: 13px; }
        .sign-img { width: 120px; height: auto; margin-bottom: -10px; }

        /* --- Mobile Responsive Settings --- */
        @media (max-width: 1024px) {
            .main-wrapper {
                flex-direction: column;
                width: 100%;
                align-items: center;
                gap: 30px;
            }
            .form-container {
                width: 95%;
            }
            .preview-container {
                width: 100%;
                height: auto;
                min-height: 297mm;
                overflow-x: auto; /* ‡∂ß‡∑ö‡∂∂‡∂Ω‡∑ä ‡∂ë‡∂ö ‡∂≠‡∑í‡∂ª‡∂∫‡∑ô‡∂±‡∑ä ‡∂¥‡∑í‡∂ß‡∂≠‡∂ß ‡∂∫‡∂±‡∑Ä‡∑è ‡∂±‡∂∏‡∑ä scroll ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏‡∂ß */
            }
            /* ‡∂Ø‡∑î‡∂ª‡∂ö‡∂Æ‡∂±‡∂∫‡∑ö‡∂Ø‡∑ì Preview ‡∂ë‡∂ö ‡∂ö‡∑î‡∂©‡∑è‡∑Ä‡∂ß ‡∂¥‡∑ô‡∂±‡∑ä‡∑Ä‡∑ì‡∂∏‡∂ß zoom ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏ (‡∑Ä‡∑í‡∂ö‡∂Ω‡∑ä‡∂¥) */
            /* .preview-container { transform: scale(0.9); transform-origin: top center; } */
        }

        @media (max-width: 600px) {
            .row { flex-direction: column; align-items: flex-start; gap: 5px; }
            .row label { width: 100%; }
            .row input { width: 100%; flex: none; }
            .btn-group { flex-wrap: wrap; }
            .preview-content { padding: 5mm 5mm 0 5mm; }
            .logo-img, .footer-banner-img { width: 100%; }
            .footer-signs { padding: 0 5mm 10px 5mm; }
            .subject-bar { font-size: 15px; }
            table { font-size: 11px; }
            th, td { padding: 5px 3px !important; }
        }

        @media print {
            @page { size: A4; margin: 0; }
            .form-container, .bottom-btns, .upload-section { display: none !important; }
            .preview-container { width: 210mm; height: 297mm; border: none; margin: 0; box-shadow: none; display: flex !important; transform: none !important; }
            .main-wrapper { width: 100%; display: block; }
            body { margin: 0; background-color: #fff; }
            .subject-bar { background-color: #f0f4f8 !important; -webkit-print-color-adjust: exact; }
            .logo-img, .footer-banner-img { width: calc(100% - 30mm); }
        }
    </style>
</head>
<body>

<div class="main-wrapper">
    <div class="form-container">
        <h2 class="header-bar">Quotation Details</h2>
        <div class="form-content">
            <div class="row">
                <label>Date:</label> <input type="text" id="in-date" value="" oninput="sync()">
                <label style="width: auto;">To:</label> <input type="text" id="in-to" value="Mr. Nilanga" oninput="sync()">
            </div>
            <div class="row">
                <label>Customer Address:</label> <input type="text" id="in-address" value="ATG CEYLON (PVT) LTD, KATUNAYAKE." oninput="sync()">
            </div>
            <div class="row">
                <label>PO No:</label> <input type="text" id="in-pono" placeholder="Enter PO No" oninput="sync()">
                <label style="width: auto;">RD No:</label> <input type="text" id="in-rdno" placeholder="Enter RD No" oninput="sync()">
            </div>
            <div class="row">
                <label>Quotation No:</label> 
                <input type="text" id="in-qno" value="SFG/2026/000" readonly style="background: #f0f0f0;">
                <label style="width: auto; font-size: 11px;"><input type="checkbox" id="chk-show-qno" onchange="sync()" checked> Show in Quote</label>
            </div>
            <div class="row">
                <label>Subject:</label> <input type="text" id="in-subject" placeholder="Enter Subject" oninput="sync()" style="border: 1px solid #444; height: 30px;">
            </div>

            <div class="items-pricing-box">
                <strong style="font-size: 13px;">Items & Pricing</strong>
                <div id="items-list">
                    <div class="item-entry">
                        <input type="text" class="i-desc" placeholder="Item Description" style="width: 95%; margin-bottom: 3px; font-size: 12px;" oninput="sync()">
                        <div style="display:flex; gap: 8px; align-items: center; font-size: 12px; flex-wrap: wrap;">
                            <div>Size: <input type="text" class="i-size" style="width: 45px;" oninput="sync()"></div>
                            <div class="hand-icons">
                                <span class="hand-box"><input type="checkbox" class="i-left" onchange="sync()"> L</span>
                                <span class="hand-box"><input type="checkbox" class="i-right" onchange="sync()"> R</span>
                            </div>
                            <div>Qty: <input type="number" class="i-qty" style="width: 40px;" oninput="sync()"></div>
                            <div>Price: <input type="number" class="i-price" style="width: 70px;" oninput="sync()"></div>
                        </div>
                    </div>
                </div>
                <div class="btn-group">
                    <button class="btn-add" onclick="addItem()">+ Add</button>
                    <button class="btn-del" onclick="delItem()">- Remove</button>
                </div>
            </div>

            <div class="row" style="margin-top: 10px;">
                <label>Value added Tax:</label> 
                <input type="number" id="in-tax" value="0" oninput="sync()" style="width: 80px; flex: none;">
                <label style="width: auto; font-size: 11px;">
                    <input type="checkbox" id="chk-show-tax" onchange="sync()"> Show in Quote
                </label>
            </div>

            <div class="terms-box">
                <p style="margin-bottom: 5px;">TERMS & CONDITIONS</p>
                <div><input type="checkbox" id="chk-est" onchange="sync()"> Above information is an estimate of goods / services</div>
                <div><input type="checkbox" id="chk-req" onchange="sync()"> At the Request of Mr. <input type="text" id="in-req-name" style="width: 100px; border-bottom: 1px solid #000; border-top:none; border-left:none; border-right:none;" oninput="sync()"></div>
                <div><input type="checkbox" id="chk-price" onchange="sync()" checked> Pricing Including of all material charges.</div>
                <div><input type="checkbox" id="chk-adv" onchange="sync()"> Please give <input type="text" id="in-adv-val" style="width: 30px;" oninput="sync()"> % Advance payment.</div>
                <div style="margin-top: 5px; color: #004085;"><input type="checkbox" id="chk-show-qr" onchange="sync()"> <strong>Include QR Code</strong></div>
            </div>

            <div class="upload-section">
                <label style="font-size: 12px; font-weight: bold;">Upload stamp:</label><br>
                <div class="upload-controls">
                    <input type="file" id="in-stamp-file" accept="image/*" onchange="handleStamp(event)" style="font-size: 11px; width: 100%;">
                    <button class="btn-img-del" onclick="deleteStamp()">Delete Image</button>
                </div>
            </div>

            <div class="bottom-btns">
                <button class="print-btn" onclick="triggerPDF()">üñ®Ô∏è Print Quotation</button>
                <button class="save-btn" id="save-btn-cloud" onclick="saveQuotationToCloud()">üíæ Save to Cloud</button>
                <a href="../DASHBOARD.html" class="dash-link">üìÅ Dashboard</a>
            </div>
        </div>
    </div>

    <div class="preview-container">
        <div class="preview-header">
            <div class="logo-section">
                <img src="image/logo.png" alt="SFG Logo" class="logo-img">
            </div>
        </div>
        
        <div class="preview-content">
            <div class="info-grid">
                <div class="customer-info-block">
                    <div class="to-label">To: </div>
                    <div class="customer-details">
                        <span id="out-to">Mr. Nilanga</span>
                        <span id="out-address"></span>
                    </div>
                </div>
                <div style="text-align: right;">
                    <strong>Date:</strong> <span id="out-date"></span><br>
                    <strong>PO No:</strong> <span id="out-pono"></span><br>
                    <strong>RD - <span id="out-rdno"></span></strong><br>
                    <span id="out-qno-container" style="display: none;"><strong>Quote No:</strong> <span id="out-qno"></span></span>
                </div>
            </div>
            <div class="subject-bar" id="out-subject"></div>
            
            <table id="quote-table">
                <thead>
                    <tr>
                        <th class="col-desc">Description</th>
                        <th class="col-size">Size</th>
                        <th class="col-side">Side</th>
                        <th class="col-qty">Qty</th>
                        <th class="col-price text-right">Price (LKR)</th>
                        <th class="col-total text-right">Total (LKR)</th>
                    </tr>
                </thead>
                <tbody id="out-table-body"></tbody>
            </table>

            <div class="summary-container">
                <div class="calculation-side">
                    <div class="total-row">
                        <span>Subtotal:</span>
                        <span id="out-sub">0.00</span>
                    </div>
                    <div class="total-row" id="out-tax-row" style="display: none;">
                        <span>Taxes:</span>
                        <span id="out-tax">0.00</span>
                    </div>
                    <div class="total-banner">
                        <span>TOTAL AMOUNT:</span>
                        <span id="out-total">LKR 0.00</span>
                    </div>
                </div>
            </div>

            <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-top: 10px;">
                <div class="footer-terms-wrap" id="out-terms-section" style="visibility: hidden;">
                    <strong>TERMS & CONDITIONS</strong><br>
                    <div id="out-terms-list"></div>
                </div>
                <div class="stamp-wrap">
                    <img id="out-stamp" src="" alt="Stamp">
                </div>
            </div>
        </div>

        <div class="footer-signs">
            <div id="qrcode-wrap">
                <div id="qrcode"></div>
            </div>
            <div class="sign-block">
                <p>Thanks & Regards,</p>
                <img src="image/sign.png" alt="Signature" class="sign-img"><br>
                <strong>H.D.Manushka Rukshan</strong><br>
                SHEHANI FIBERGLASS WORKS
            </div>
        </div>

        <img src="image/0123 copy.png" alt="Footer Contact Info" class="footer-banner-img">
    </div>
</div>

<script>
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxgT-XnC7vwMBeAglrjnS1ud82lsHvy-BQKaygYTos9SQhXPL2uj6L3dNa9sp_kji0Xvg/exec";

    let defaultTitle = document.title;
    
    function setTodaysDate() {
        const today = new Date();
        const dd = String(today.getDate()).padStart(2, '0');
        const mm = String(today.getMonth() + 1).padStart(2, '0'); 
        const yyyy = today.getFullYear();
        document.getElementById('in-date').value = dd + '/' + mm + '/' + yyyy;
    }

    function triggerPDF() {
        const rd = document.getElementById('in-rdno').value || "No-RD";
        const subject = document.getElementById('in-subject').value || "No-Subject";
        const dateStr = document.getElementById('in-date').value.replace(/\//g, "-");
        document.title = `RD ${rd} - ${subject} (${dateStr})`;
        window.print();
        setTimeout(() => { document.title = defaultTitle; }, 1000);
    }

    function handleStamp(event) {
        const file = event.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                const img = document.getElementById('out-stamp');
                img.src = e.target.result;
                img.style.display = 'block';
            }
            reader.readAsDataURL(file);
        }
    }

    function deleteStamp() {
        const img = document.getElementById('out-stamp');
        img.src = "";
        img.style.display = 'none';
        document.getElementById('in-stamp-file').value = "";
    }

    function addItem() {
        const list = document.getElementById('items-list');
        const div = document.createElement('div');
        div.className = 'item-entry';
        div.innerHTML = `
            <input type="text" class="i-desc" placeholder="Item Description" style="width: 95%; margin-bottom: 3px; font-size: 12px;" oninput="sync()">
            <div style="display:flex; gap: 8px; align-items: center; font-size: 12px; flex-wrap: wrap;">
                <div>Size: <input type="text" class="i-size" style="width: 45px;" oninput="sync()"></div>
                <div class="hand-icons">
                    <span class="hand-box"><input type="checkbox" class="i-left" onchange="sync()"> L</span>
                    <span class="hand-box"><input type="checkbox" class="i-right" onchange="sync()"> R</span>
                </div>
                <div>Qty: <input type="number" class="i-qty" style="width: 40px;" oninput="sync()"></div>
                <div>Price: <input type="number" class="i-price" style="width: 70px;" oninput="sync()"></div>
            </div>`;
        list.appendChild(div);
        sync();
    }

    function delItem() {
        const entries = document.querySelectorAll('.item-entry');
        if(entries.length > 1) entries[entries.length-1].remove();
        sync();
    }

    function generateQNo() {
        const dateVal = document.getElementById('in-date').value;
        const rdVal = document.getElementById('in-rdno').value;
        const combined = (dateVal + rdVal).replace(/\D/g, '');
        let sum = 0;
        for (let i = 0; i < combined.length; i++) { sum += parseInt(combined[i]) * (i + 1); }
        const uniquePart = (sum % 1000).toString().padStart(3, '0');
        const finalNo = `SFG/2026/${uniquePart}`;
        document.getElementById('in-qno').value = finalNo;
        document.getElementById('out-qno').innerText = finalNo;
    }

    function sync() {
        generateQNo();
        document.getElementById('out-date').innerText = document.getElementById('in-date').value;
        document.getElementById('out-to').innerText = document.getElementById('in-to').value;
        let rawAddr = document.getElementById('in-address').value;
        let formattedAddr = rawAddr.replace("LTD,", "LTD,<br>");
        document.getElementById('out-address').innerHTML = formattedAddr;
        document.getElementById('out-rdno').innerText = document.getElementById('in-rdno').value;
        document.getElementById('out-pono').innerText = document.getElementById('in-pono').value;
        document.getElementById('out-subject').innerText = document.getElementById('in-subject').value;
        const showQNo = document.getElementById('chk-show-qno').checked;
        document.getElementById('out-qno-container').style.display = showQNo ? 'inline' : 'none';
                
        const tableBody = document.getElementById('out-table-body');
        tableBody.innerHTML = '';
        let subtotal = 0;
        
        const entries = document.querySelectorAll('.item-entry');
        let activeItems = [];
        entries.forEach(entry => {
            const desc = entry.querySelector('.i-desc').value;
            const qty = parseFloat(entry.querySelector('.i-qty').value) || 0;
            if(desc || qty) activeItems.push(entry);
        });

        activeItems.forEach(entry => {
            const desc = entry.querySelector('.i-desc').value;
            const size = entry.querySelector('.i-size').value;
            const l = entry.querySelector('.i-left').checked;
            const r = entry.querySelector('.i-right').checked;
            const qty = parseFloat(entry.querySelector('.i-qty').value) || 0;
            const price = parseFloat(entry.querySelector('.i-price').value) || 0;
            let side = l && r ? "Pair" : (l ? "L" : (r ? "R" : "-"));
            let rowTotal = qty * price;
            
            subtotal += rowTotal;
            const tr = document.createElement('tr');
            tr.innerHTML = `<td>${desc}</td><td>${size}</td><td>${side}</td><td>${qty.toString().padStart(2, '0')}</td><td class="text-right">${price.toLocaleString(undefined, {minimumFractionDigits: 2})}</td><td class="text-right">${rowTotal.toLocaleString(undefined, {minimumFractionDigits: 2})}</td>`;
            tableBody.appendChild(tr);
        });

        const showTax = document.getElementById('chk-show-tax').checked;
        const taxVal = parseFloat(document.getElementById('in-tax').value) || 0;
        const totalAmountNum = subtotal + (showTax ? taxVal : 0);
                
        document.getElementById('out-tax-row').style.display = showTax ? 'flex' : 'none';
        document.getElementById('out-sub').innerText = subtotal.toLocaleString(undefined, {minimumFractionDigits: 2});
        document.getElementById('out-tax').innerText = taxVal.toLocaleString(undefined, {minimumFractionDigits: 2});
        document.getElementById('out-total').innerText = "LKR " + totalAmountNum.toLocaleString(undefined, {minimumFractionDigits: 2});
                
        const termsList = document.getElementById('out-terms-list');
        const termsSection = document.getElementById('out-terms-section');
        termsList.innerHTML = '';
        let hasTerms = false;
        if(document.getElementById('chk-est').checked) { termsList.innerHTML += '‚Ä¢ Above information is an estimate of goods / services<br>'; hasTerms = true; }
        if(document.getElementById('chk-req').checked) { termsList.innerHTML += `‚Ä¢ At the Request of Mr. ${document.getElementById('in-req-name').value}<br>`; hasTerms = true; }
        if(document.getElementById('chk-price').checked) { termsList.innerHTML += '‚Ä¢ Pricing Including of all material charges.<br>'; hasTerms = true; }
        if(document.getElementById('chk-adv').checked) { termsList.innerHTML += `‚Ä¢ Please give ${document.getElementById('in-adv-val').value}% Advance payment.<br>`; hasTerms = true; }
        termsSection.style.visibility = hasTerms ? 'visible' : 'hidden';

        if (document.getElementById('chk-show-qr').checked) {
            document.getElementById('qrcode-wrap').style.visibility = 'visible';
            updateQRCode("SFG QUOTE: LKR " + totalAmountNum.toLocaleString());
        } else {
            document.getElementById('qrcode-wrap').style.visibility = 'hidden';
        }
    }

    function updateQRCode(text) {
        const qrContainer = document.getElementById("qrcode");
        qrContainer.innerHTML = "";
        new QRCode(qrContainer, { text: text, width: 115, height: 115 });
    }

    async function saveQuotationToCloud() {
        const saveBtn = document.getElementById('save-btn-cloud');
        const originalText = saveBtn.innerText;
        
        const rdNo = document.getElementById('in-rdno').value || "N/A";
        const subject = document.getElementById('in-subject').value || "No Subject";
        const date = document.getElementById('in-date').value;
        const total = document.getElementById('out-total').innerText;
        const address = document.getElementById('in-address').value;
        const pono = document.getElementById('in-pono').value;
        const qno = document.getElementById('in-qno').value;

        const quoteData = {
            id: Date.now(),
            date: date,
            rdNo: rdNo,
            subject: subject,
            total: total,
            poNo: pono,
            quoteNo: qno,
            address: address,
            isSend: false,
            isPending: true,
            isCompleted: false,
            isPaid: false
        };

        saveBtn.innerText = "‚è≥ Saving...";
        saveBtn.disabled = true;

        try {
            await fetch(SCRIPT_URL, {
                method: 'POST',
                body: JSON.stringify(quoteData),
                mode: 'no-cors',
                headers: {
                    'Content-Type': 'text/plain'
                }
            });

            alert("Cloud ‡∂ë‡∂ö‡∂ß ‡∑É‡∑è‡∂ª‡∑ä‡∂Æ‡∂ö‡∑Ä ‡∂∫‡∑ú‡∂∏‡∑î ‡∂ö‡∑Ö‡∑è!");
            window.location.href = '../DASHBOARD.html';
        } catch (error) {
            console.error('Error:', error);
            alert("‡∑É‡∑ö‡∑Ä‡∑ä ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏ ‡∂Ö‡∑É‡∑è‡∂ª‡∑ä‡∂Æ‡∂ö‡∂∫‡∑í. ‡∂Ö‡∂±‡∑ä‡∂≠‡∂ª‡∑ä‡∂¢‡∑è‡∂Ω‡∂∫ ‡∂¥‡∂ª‡∑ì‡∂ö‡∑ä‡∑Ç‡∑è ‡∂ö‡∂ª‡∂±‡∑ä‡∂±.");
        } finally {
            saveBtn.innerText = originalText;
            saveBtn.disabled = false;
        }
    }

    window.onload = function() { 
        setTodaysDate(); 
        sync(); 
    };
</script>
</body>
</html>




